# 2DEMC

## Motivation. 

The predominant way to resolve the structure of fragile single proteins is by scattering probes (e.g., x-ray photons, or electrons) with Angstroms-scale wavelengths. These probes are extremely energetic, thus it is physically impossible to probe such proteins without substantial inelastic scattering, which in turn alters and damages these proteins. Put differently, the act of observing these proteins also destroys and degrades them. Because of this damage, it is hence impossible to repeatedly interrogate *the same single protein* presented at various orientations, as you would say with a patient in a medical CT scan, to obtain its 3D structure.

**How then can we obtain the 3D structure of proteins?** Experimentally, a prerequisite is to arrest the proteins' motion at the atomic length scale during exposure to the imaging probe. One solution has been to crystallize proteins, which effectively "locks" many millions of proteins into a specific orientation in space (with respect to the crystal). This method is known as macromolecular crystallography (MX). However, even in MX there will still be structural variations between millions of copies of the protein in the crystal due to thermal vibration, disorientations (owing to strains/defects in crystal), flexibility within each protein. More importantly, the vast majority of proteins do not naturally form crystals and it usually take an enormous amount of (somewhat guided) biochemical trial-and-error to create a sufficiently large and ordered protein crystal. While MX has given us $\sim 180,000$ protein structures, there are at least an order of magnitude more proteins whose structures remain unknown.

**A way of overcoming these issues of MX is high-throughput *single particle imaging (SPI)*.** The idea is to illuminate single particles (each particle is a "copy" of an entire protein) and computationally infer the average particle's structure from many such single-particle diffraction pattern. Because we know each pattern comes from exactly one protein (when the experimental conditions are tuned correctly), so even though each protein might be structurally different from others, we can computationally select for patterns from structurally similar single particles. Hence, the average structure inferred from patterns of similar proteins will also yield much more homogeneous structures.

**Single-particle imaging, in this fashion, this requires an ultrafast (i.e., femtosecond, $\sim 10^{-15}$ s, pulses) x-ray laser.** Consider how it takes $\sim 10^{-17}$ s for *a single photon* to traverse a nanometer sized protein. During this short time, the protein's atoms (at room temperature) are essentially static. However, that's just one scattered photon per particle, which is insufficient for inference. It has been empirically shown that $100-1000$ scattered photons per particle are needed to infer the latent (i.e., unknown) orientation of each particle. Without inferring this latent orientation information, it is impossible to recover the particle's 3D structure. What's worse, because of the small scattering cross section between x-ray photons and typical proteins (<!--$\sim 10^{-30} \times 10^{20}$--> $< 10^{-10} \text{m}^2$), to scatter 100s of photons requires extremely bright x-ray pulses whose incident intensities approach $10^{12} \text{ photons}/(\mu \text{m}^2)$. 

**What about beam-induced damage?** Well, if any pair of photons that illuminate a protein are separated more than a few femtoseconds, these two photons will see structurally different versions of said protein -- typically the first photon will initiate the protein's perturbation/destruction. Hence, these x-ray pulses must also be of order of a few femtoseconds (i.e., ultrafast). This type of ultrafast imaging is sometimes referred to as *outrunning the damage*, *diffraction-before-destruction*, or *FLASH-imaging*.

### A low-dimensional toy problem.
In single particle imaging we have to discover the latent orientations of each pattern before the structure of the imaged sample emerges. It is possible to simplify this orientation discovery problem into a simple toy model. The toy model can be easily generalized to the full set of 3D rotations in $SO(3)$, or to infer latent parameters in similar problems where a good likelihood model is known.  

In this toy problem, you are given hundreds of thousands of noisy photon patterns. Each pattern is a shot-noise limited image of the ground truth particle. Unfortunately, each of the pattern is randomly presented at one of four possible 90-degree rotations. 
